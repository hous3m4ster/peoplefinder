<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: message_classes/message.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: message_classes/message.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";

/************
 * Requires *
 ************/

var _ = require("lodash");


/*********************
 * The Message class *
 *********************/

/**
 * Represents a generic message received by a bot
 */
class Message {
	/**
	 * Creates a new instance of the Message class
	 *
	 *Â @param {Object} message	A message from an update object. See the [bot API]{@link https://core.telegram.org/bots/api#message}
	 * @param {BotAPI} API	An instance of a BotAPI from teleapiwrapper which will be used to do stuff with this message
	 *
	 * @private
	 */
	constructor(message, API) {
		// Make a JSON string of the message, for easy copying
		let copy = JSON.stringify(message);

		/**
		 * A copy of the original message given to the constructor
		 */
		this.rawMessage = JSON.parse(copy);

		/**
		 * An extended version of the message given to the constructor, with all non-existent fields set to null
		 */
		this.extendedMessage = JSON.parse(copy);
		_.defaults(this.extendedMessage, defaultMessage);

		/**
		 * The api to use for this message
		 *
		 * @private
		 */
		this._API = API;
	}

	/**
	 * Upgrades the message to a subclass of the message. Won't actually upgrade the message, but return a new instance of the subclass you provide with the same data as this message
	 *
	 * @param {Function} messageType	The type of message to upgrade this one to
	 * @return {messageType}	A new instance of the type of message you wanted this one upgraded to
	 * @private
	 */
	_upgradeTo(messageType) {
		return new messageType(this.rawMessage, this._API);
	}

	/**
	 * The user object of the sender of this message. See [the API]{@link https://core.telegram.org/bots/api#user}
	 *
	 * @readonly
	 */
	get sender() {
		return this.rawMessage.from;
	}

	/**
	 * The chat object of the chat this message came from. See [the API]{@link https://core.telegram.org/bots/api#chat}
	 *
	 * @readonly
	 */
	get chat() {
		return this.rawMessage.chat;
	}

	/**
	 * Forwards this message to a chat
	 *
	 * @param {Integer|String} chatId	ID of the chat to forward the message to
	 *
	 * @return {Promise}	The promise returned from teleapiwrapper's forwardMessage()
	 */
	forward(chatId) {
		return this._API.forwardMessage({
			chat_id: chatId,
			from_chat_id: this.rawMessage.chat.id,
			message_id: this.rawMessage.message_id
		});
	}

	/**
	 * Sends a reply to a message
	 * @see {@link Message#answer}
	 *
	 * @param {String} text	The text to reply with
	 *
	 * @return {Promise}	The promise returned from teleapiwrapper's forwardMessage()
	 */
	reply(text) {
		return this._API.sendMessage({
			chat_id: this.rawMessage.chat.id,
			text: text,
			reply_to_message_id: this.rawMessage.message_id
		});
	}

	/**
	 * Sends a message to the same chat this message came from
	 * @see {@link Message#reply}
	 *
	 * @param {String} text	The text to send
	 *
	 * @return {Promise}	The promise returned from teleapiwrapper's forwardMessage()
	 */
	answer(text) {
		return this._API.sendMessage({
			chat_id: this.rawMessage.chat.id,
			text: text
		});
	}
}

// Make an object with all the properties of a message object to use as default for extending
var defaultMessage = {
	message_id: null,
	from: null,
	date: null,
	chat: null,
	forward_from: null,
	forward_date: null,
	reply_to_message: null,
	text: null,
	audio: null,
	document: null,
	photo: null,
	sticker: null,
	video: null,
	voice: null,
	caption: null,
	contact: null,
	location: null,
	new_chat_participant: null,
	left_chat_participant: null,
	new_chat_title: null,
	new_chat_photo: null,
	delete_chat_photo: null,
	group_chat_created: null,
	supergroup_chat_created: null,
	channel_chat_created: null,
	migrate_to_chat_id: null,
	migrate_from_chat_id: null
};

/***********
 * Exports *
 ***********/

module.exports = Message;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="CommandMessage.html">CommandMessage</a></li><li><a href="ContactMessage.html">ContactMessage</a></li><li><a href="FileMessage.html">FileMessage</a></li><li><a href="ForwardedMessage.html">ForwardedMessage</a></li><li><a href="LocationMessage.html">LocationMessage</a></li><li><a href="Message.html">Message</a></li><li><a href="MessageSorter.html">MessageSorter</a></li><li><a href="ReplyMessage.html">ReplyMessage</a></li><li><a href="TelegramBot.html">TelegramBot</a></li><li><a href="TextMessage.html">TextMessage</a></li><li><a href="UpdateGetter.html">UpdateGetter</a></li></ul><h3>Events</h3><ul><li><a href="MessageSorter.html#event:audio">audio</a></li><li><a href="MessageSorter.html#event:channel_chat_created">channel_chat_created</a></li><li><a href="MessageSorter.html#event:chat_migrated">chat_migrated</a></li><li><a href="MessageSorter.html#event:chosen_inline_result">chosen_inline_result</a></li><li><a href="MessageSorter.html#event:command">command</a></li><li><a href="MessageSorter.html#event:contact">contact</a></li><li><a href="MessageSorter.html#event:delete_chat_photo">delete_chat_photo</a></li><li><a href="MessageSorter.html#event:document">document</a></li><li><a href="MessageSorter.html#event:error">error</a></li><li><a href="MessageSorter.html#event:file">file</a></li><li><a href="MessageSorter.html#event:forward">forward</a></li><li><a href="MessageSorter.html#event:group_chat_created">group_chat_created</a></li><li><a href="MessageSorter.html#event:inline_query">inline_query</a></li><li><a href="MessageSorter.html#event:left_chat_participant">left_chat_participant</a></li><li><a href="MessageSorter.html#event:location">location</a></li><li><a href="MessageSorter.html#event:message">message</a></li><li><a href="MessageSorter.html#event:multi_type">multi_type</a></li><li><a href="MessageSorter.html#event:new_chat_participant">new_chat_participant</a></li><li><a href="MessageSorter.html#event:new_chat_photo">new_chat_photo</a></li><li><a href="MessageSorter.html#event:new_chat_title">new_chat_title</a></li><li><a href="MessageSorter.html#event:photo">photo</a></li><li><a href="MessageSorter.html#event:reply">reply</a></li><li><a href="MessageSorter.html#event:sticker">sticker</a></li><li><a href="MessageSorter.html#event:supergroup_chat_created">supergroup_chat_created</a></li><li><a href="MessageSorter.html#event:text">text</a></li><li><a href="MessageSorter.html#event:update">update</a></li><li><a href="MessageSorter.html#event:video">video</a></li><li><a href="MessageSorter.html#event:voice">voice</a></li><li><a href="TelegramBot.html#event:audio">audio</a></li><li><a href="TelegramBot.html#event:channel_chat_created">channel_chat_created</a></li><li><a href="TelegramBot.html#event:chat_migrated">chat_migrated</a></li><li><a href="TelegramBot.html#event:chosen_inline_result">chosen_inline_result</a></li><li><a href="TelegramBot.html#event:command">command</a></li><li><a href="TelegramBot.html#event:contact">contact</a></li><li><a href="TelegramBot.html#event:delete_chat_photo">delete_chat_photo</a></li><li><a href="TelegramBot.html#event:document">document</a></li><li><a href="TelegramBot.html#event:error">error</a></li><li><a href="TelegramBot.html#event:file">file</a></li><li><a href="TelegramBot.html#event:forward">forward</a></li><li><a href="TelegramBot.html#event:group_chat_created">group_chat_created</a></li><li><a href="TelegramBot.html#event:inline_query">inline_query</a></li><li><a href="TelegramBot.html#event:left_chat_participant">left_chat_participant</a></li><li><a href="TelegramBot.html#event:location">location</a></li><li><a href="TelegramBot.html#event:message">message</a></li><li><a href="TelegramBot.html#event:multi_type">multi_type</a></li><li><a href="TelegramBot.html#event:new_chat_participant">new_chat_participant</a></li><li><a href="TelegramBot.html#event:new_chat_photo">new_chat_photo</a></li><li><a href="TelegramBot.html#event:new_chat_title">new_chat_title</a></li><li><a href="TelegramBot.html#event:photo">photo</a></li><li><a href="TelegramBot.html#event:reply">reply</a></li><li><a href="TelegramBot.html#event:sticker">sticker</a></li><li><a href="TelegramBot.html#event:supergroup_chat_created">supergroup_chat_created</a></li><li><a href="TelegramBot.html#event:text">text</a></li><li><a href="TelegramBot.html#event:update">update</a></li><li><a href="TelegramBot.html#event:video">video</a></li><li><a href="TelegramBot.html#event:voice">voice</a></li><li><a href="UpdateGetter.html#event:chosen_inline_result">chosen_inline_result</a></li><li><a href="UpdateGetter.html#event:error">error</a></li><li><a href="UpdateGetter.html#event:inline_query">inline_query</a></li><li><a href="UpdateGetter.html#event:message">message</a></li><li><a href="UpdateGetter.html#event:update">update</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Thu Jan 14 2016 18:16:36 GMT+0100 (CET)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
